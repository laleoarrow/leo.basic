% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/5.compare.R
\name{leo_permutation_test}
\alias{leo_permutation_test}
\title{leo_permutation_test: flexible one-way permutation / rank-based testing}
\usage{
leo_permutation_test(
  data,
  class_vec = NULL,
  class_col = "Class",
  feature_cols = NULL,
  set_seed = 725
)
}
\arguments{
\item{data}{Numeric vector \emph{or} data.frame.}

\item{class_vec}{Grouping vector when \code{data} is numeric (length must
match \code{data}); accepted as 0/1 or any two-level factor/character.}

\item{class_col}{Character. Column name of grouping variable in a
data.frame. Default \code{"Class"}.}

\item{feature_cols}{Character vector of feature columns in the data.frame.
If \code{NULL} (default), all numeric columns except \code{class_col} are
used.}

\item{set_seed}{Integer random seed (passed to \code{set.seed}). Default
\code{725}.}
}
\value{
A tibble with three columns:
\describe{
\item{Feature}{Feature name}
\item{P}{P-value}
\item{Type}{Test used: \code{"oneway"} or \code{"wilcox"}}
}
}
\description{
Compare one or multiple numeric features between two groups
using permutation-based tests from \strong{coin}. Two usage modes:
\enumerate{
\item \strong{Vector mode} – supply a numeric vector \code{data} and a grouping
vector \code{class_vec}.
\item \strong{Data-frame mode} – supply a data.frame \code{data} plus the
column name holding the groups (\code{class_col}) and, optionally,
the feature columns (\code{feature_cols}).
}
Workflow per feature:
\itemize{
\item Normality test — Shapiro–Wilk for \eqn{n ≤ 5000}, Anderson–Darling
for \eqn{n > 5000}.
\item Variance homogeneity — F-test.
\item If both criteria hold, run \code{coin::oneway_test}; otherwise run
\code{coin::wilcox_test}.
}
}
\examples{
## vector mode --------------------------------------------------------------
set.seed(1)
feat <- rnorm(100); cls <- rep(c(0, 1), each = 50)
leo_permutation_test(feat, class_vec = cls)

## data-frame mode: specify feature columns ---------------------------------
df <- data.frame(Class = cls,
                 F1 = feat,
                 F2 = rnorm(100, 0.3),
                 F3 = rnorm(100, 1))
leo_permutation_test(df, class_col = "Class", feature_cols = c("F1", "F2", "F3"))

## data-frame mode: all numeric features except Class -----------------------
leo_permutation_test(df, class_col = "Class")

## large-n example triggers AD test -----------------------------------------
big_feat <- rnorm(6000); big_grp <- rep(c(0, 1), each = 3000)
leo_permutation_test(big_feat, class_vec = big_grp)
}
